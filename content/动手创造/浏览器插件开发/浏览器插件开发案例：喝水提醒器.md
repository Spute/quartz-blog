---
title: 浏览器插件开发案例--喝水提醒器
---

## 效果展示

点击插件图标，弹出弹窗，选择喝水提醒时间

![[Wqqub7ZAnoeRbMx8LEwcmqEVnjb.png]]

设计好后，插件图标发生变化

![[TomzbMBsaoi4gExqr5Ecf8uAn0f.png]]

到时间后，就会在又下角出现提示弹窗

![[T9HVbtSukom3uuxepmxczgxqn2e.png]]

## 部署步骤

将以下安装包解压后，拖拽到扩展程序页面安装即可

## 学习知识点

这个 background.js 是一个 Chrome 扩展的后台脚本，用于实现定时喝水提醒功能。其主要作用如下：

1. 定时提醒：当定时器（alarm）触发时，会清空扩展图标上的徽章文字，并弹出一个通知，提醒用户“该喝水了”。
2. 通知按钮：如果用户点击通知上的按钮，会重新读取用户设置的分钟数，重新设置定时器，并在扩展图标上显示“ON”字样，表示提醒已激活。

```javascript
// Copyright 2017 The Chromium Authors. All rights reserved.
// 使用 BSD 风格许可证，详见 LICENSE 文件。
'use strict';

// 当定时器（alarm）触发时执行
chrome.alarms.onAlarm.addListener(() => {
  // 清空扩展图标上的徽章文字
  chrome.action.setBadgeText({ text: '' });
  // 创建喝水提醒通知
  chrome.notifications.create({
    type: 'basic',
    iconUrl: 'stay_hydrated.png',
    title: 'Time to Hydrate', // 通知标题
    message: "Everyday I'm Guzzlin'!", // 通知内容
    buttons: [{ title: 'Keep it Flowing.' }], // 通知按钮
    priority: 0
  });
});

// 当用户点击通知按钮时执行
chrome.notifications.onButtonClicked.addListener(async () => {
  // 从存储中获取用户设置的分钟数
  const item = await chrome.storage.sync.get(['minutes']);
  // 在扩展图标上显示“ON”
  chrome.action.setBadgeText({ text: 'ON' });
  // 重新设置定时器
  chrome.alarms.create({ delayInMinutes: item.minutes });
});
```
