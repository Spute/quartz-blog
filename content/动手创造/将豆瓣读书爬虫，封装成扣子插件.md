---
title: 将豆瓣读书爬虫，封装成扣子插件
---

# 将豆瓣读书爬虫，封装成扣子插件

爬虫程序：[豆瓣读书书评爬取](https://iixchzsb7i.feishu.cn/wiki/As1twpVwciiKPekJ4gZcHNx5n3d)

为了在 coze 中方便地调用之前写好的豆瓣书籍爬虫程序，我们可以把它封装成一个 coze 插件。以下相关的操作步骤。

## 创建插件

在工作空间的“资源”栏中新建一个插件。选择在 IDE 中创建工具，选择运行的编程语言（我这里选择的是更熟悉的 Python 语言）。

![[KhZ6bnwU5oQqBzxWjdfciD35n6g.png]]

## 添加工具

在插件这个工具箱中，添加一个具体的工具

![[SMAdbxx2UoFQGExQCEdc7knJnad.png]]

## 编辑工具元数据

在元数据中，加好输入参数的 book_id，输出参数这是一个 Array 类型的数组，返回前 20 条短评。

![[UqIHbR2WdoOvSZxALhScrc4Hnxf.png]]

## 编辑工具代码

将之前调试好的爬虫代码粘贴过来，然后编辑以下入口函数，保证输入和输出于元数据中一致：

```
def handler(args: Args[Input])->Output:
    
    data = main(book_id=args.input.book_id)
    return {"comments": data}
```

PS: “args: Args[Input] ”参数表示是<strong>一个 Args 类型的对象，内部包含 Input 类型的数据</strong>。Input 类型的数据中又有 book_id 字段。所以使用“args.input.book_id”来获取书籍 id 这个输入参数。

![[IB6SbFKx1oOEw5xWlpkcxIxhnae.png]]

## 添加第三方依赖包

添加除了标准库外的第三方包，这个爬虫使用到的第三方包有：beautifulsoup4 和 requests

![[L0ADbLTQxoJVuJxSSp1ciTganKe.png]]

## 测试

完成以上步骤后，需要运行测试一下，ok 后则可以发布了。

![[YC6Mb5W7Jo0PUNx77pRcWCUOnwg.png]]
